%%=============================================================================
%% Methodologie
%%=============================================================================

\chapter{\IfLanguageName{dutch}{Methodologie}{Methodology}}%
\label{ch:methodologie}

%% TODO: Hoe ben je te werk gegaan? Verdeel je onderzoek in grote fasen, en
%% licht in elke fase toe welke stappen je gevolgd hebt. Verantwoord waarom je
%% op deze manier te werk gegaan bent. Je moet kunnen aantonen dat je de best
%% mogelijke manier toegepast hebt om een antwoord te vinden op de
%% onderzoeksvraag.

Om een antwoord te vinden op deze onderzoeksvraag, worden de volgende stappen gehanteerd. \\

Als eerste wordt het onderzoeksdomein volledig gekaderd aan de hand van een literaire stand van zaken. Na het verzamelen en verwerken van alle literaire studies, volgt de vergelijking tussen het oude en het nieuwe. Zoals reeds vermeld wordt de PowerShell-module en \ac{API} van Azure \ac{AD} uitgefaseerd. Azure \ac{AD} wordt gezien als het “oude”. De nieuwe Microsoft Graph, de vervanger van Azure \ac{AD}, wordt gezien in de vergelijking als het “nieuwe”. \\

De vergelijking tussen de twee bevat de eerste helft van het antwoord op de onderzoeksvraag. In deze vergelijking wordt er gekeken naar vier onderdelen.

\begin{itemize}
    \item Logica: Hoe worden de gegevens van start tot eind verwerkt?
    \item Data-objecten: Welke data-objecten kunnen worden aangesproken?
    \item Gebruik: Hoe wordt er geauthenticeerd en geautoriseerd? Waar en hoe maken we gebruik van deze technologie?
    \item Security: Hoe wordt er geauthenticeerd, en is deze authenticatiemethode veilig? Wordt er gebruikgemaakt van rechten om misbruik tegen te gaan?
\end{itemize}

Met deze vier onderdelen wordt de vergelijking tussen het oude en het nieuwe uitgevoerd. Deze vergelijking wordt aan de hand van de verwerkte literatuur toegepast. \\

Om de tweede helft van het antwoord te geven op de onderzoeksvraag wordt de casus praktisch uitgewerkt in een Proof-of-Concept. Het verouderde Audit-script van Easi, dat geschreven is in PowerShell, maakt gebruik van de verouderde modules. Dit script wordt vernieuwd door middel van Microsoft Graph. Door dit script te herwerken wordt er op een praktisch manier aangetoond wat vandaag de dag wel en niet mogelijk is met Microsoft Graph. \\

Tijdens de uitwerking van de Proof-of-Concept wordt er gewerkt met een zes stappenplan. \\

Om dit script zo efficiënt mogelijk te herwerken, worden twintig kleinere onderdelen van dit script behandeld. Deze twintig onderdelen maken gebruik van de uitfaserende Azure \ac{AD} PowerShell-module. Hieronder worden de twintig onderdelen opgesomd met een korte beschrijving. 

\begin{enumerate}
    \item Alle aanwezige domeinen binnen de Office 365-omgeving.
    \item Aantal gebruikers binnen de omgeving, onderverdeeld in interne en externe gebruikers.
    \item Aantal gebruikers die geblokkeerd zijn.
    \item Aantal licenties.
    \item Overzicht en telling van gebruikers met administrator-privileges.
    \item Overzicht en telling van gebruikers met \ac{MFA}.
    \item Aantal gelicenseerde, actieve accounts waarbij \ac{MFA} uitstaat.
    \item Aantal externe accounts waarbij \ac{MFA} uitstaat.
    \item Overzicht van accounts met administrator-priviliges, onderverdeeld in gebruik van \ac{MFA}.
    \item Groottes van elk type mailbox.
    \item Groottes van elke mailbox, gerankschikt van groot naar klein.
    \item Onderverdeling van gebruikersmailboxes op basis van grootte.
    \item Onderverdeling van gedeelde mailboxen op basis van grootte.
    \item Onderverdeling van hoeveelheid mailboxen per domein.
    \item Overzicht van accounts met als primair \Ac{SMTP}-adresdomein “.onmicrosoft.com”.
    \item Overzicht gedeelde mailboxen, onderverdeeld in aanwezigheid van een licentie.
    \item Overzicht van verborgen mailboxen.
    \item Overzicht van email-forwarding.
    \item Overzicht verschillende types van licenties en het aantal personen met dit licentietype.
    \item Overzicht verschillende methodes waarop \ac{MFA} wordt gebruikt met hoeveelheid gebruikers, onderverdeeld op basis van methode.
\end{enumerate}

Binnen deze twintig onderdelen zijn er vijf domeinen. Dit zijn de vijf domeinen waar op gefocust wordt wanneer klanten een audit uitvoeren door Easi. Deze vijf domeinen worden hieronder weergegeven. 

\begin{itemize}
    \item domeinen
    \item gebruikers
    \item licenties
    \item mailboxes
    \item \ac{MFA}
\end{itemize}

Tijdens de praktische uitwerking wordt er gebruikgemaakt van de Microsoft Graph PowerShell-modules. In het specifiek, de meest recente versie van de eerste stabiele uitrol dat beschikbaar is tijdens de uitvoering van dit onderzoek, namelijk versie 1.25 \autocite{Microsoft2023k}. De mogelijkheid is reëel dat er tijdens of na de uitwerking een recentere versie zal worden uitgegeven door Microsoft. Er wordt niet afgeweken van versie 1.25 met bijhorende modules in dit onderzoek. \\  

Wanneer het onderdeel kan worden uitgevoerd via de PowerShell-modules van Microsoft Graph, dan wordt er een PowerShell-script uitgewerkt voor dat onderdeel. Dit bewijst dat Microsoft Graph kan gebruikt worden voor de vervanging van Azure \ac{AD} en MSonline van het Audit-script. \\

Als een onderdeel niet kan worden uitgevoerd via de Microsoft Graph PowerShell-modules, dan wordt er dieper gekeken naar het bijhorende domein. Er wordt uitgezocht dat het domein wel of niet ondersteund wordt door de PowerShell-modules van Microsoft Graph. Een mogelijk alternatief wordt besproken, maar de uitwerking hiervan valt buiten de scope van dit onderzoek. \\

Uiteindelijk wordt een conclusie gevormd op basis van beide helften uit dit onderzoek. 